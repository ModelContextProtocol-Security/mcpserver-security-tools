---
arxiv_id: "2510.23673"
title: "MCPGuard: Automatically Detecting Vulnerabilities in MCP Servers"
authors: [Bin Wang, Zexin Liu, Hao Yu, Ao Yang, Yenan Huang, Jing Guo, Huangsheng Cheng, Hui Li, Huiyu Wu]
institutions: [Peking University, Tencent]
analyzed: 2026-02-04
---

## Paper Summary

This paper is a **survey/systematization** of MCP security threats and defenses, identifying three principal threat categories and comprehensively reviewing defense strategies. It provides a high-level overview of the MCP security landscape rather than presenting novel attacks or tools.

**Core contribution:** Synthesis of existing knowledge on MCP security, categorized into attack types and defense approaches.

**Key insight:** MCP security represents a paradigm shift where the attack surface extends from traditional code execution to semantic interpretation of natural language metadata.

## Attack/Threat Coverage

### Three Principal Threat Categories

#### 1. Agent Hijacking from Protocol Deficiencies

MCP clients inject tool descriptions directly into context without adequate isolation:
- **Tool Poisoning Attacks** - Malicious instructions in tool descriptions
- **Rug Pulls** - Initially benign tools updated with malicious payloads
- **Tool Shadowing Attacks** - Conflicting tool names/global rules
- **Indirect Prompt Injection** - Malicious content in external data parsed as instructions

#### 2. Traditional Web Vulnerabilities in MCP Servers

MCP servers expose conventional web attack surfaces:
- Command injection
- Path traversal
- Arbitrary file read
- Server-Side Request Forgery (SSRF)
- **CVE-2025-49596** - RCE in Anthropic's official MCP Inspector tool

#### 3. Supply Chain Security

No unified trusted marketplace or vetting mechanism:
- **Tool Poisoning** - Malicious instructions in metadata treated as trusted guidance
- **Tool Shadowing** - Same name, different implementation
- **Rug Pulls** - Post-trust injection of backdoors
- **MCP Preference Manipulation Attacks (MPMAs)** - Optimizing tool names/descriptions to increase selection probability

### Paradigm Shift Observation

> "The protocol treats natural language tool metadata as authoritative input for LLM decision-making, yet provides no mechanisms to verify the provenance, integrity, or semantic safety of this metadata."

Traditional: Code execution vulnerabilities
MCP: Semantic interpretation of natural language

## Defense/Mitigation Proposals

### Server-Side Scanning Approaches

#### 1. MCP-Guard (Layered Pipeline)
Three-stage detection:
1. **Static scanning** - Pattern-based detection with hot updates
2. **Neural detection** - Pre-trained embedding model fine-tuned on MCP threats
3. **LLM arbitrator** - Semantic safety assessment for uncertain cases

**Claimed:** 96% accuracy

#### 2. McpSafetyScanner (Agentic Framework)
Multi-agent auditing:
- Hacker agent probes vulnerabilities
- Auditor agent searches knowledge bases
- Supervisor agent generates reports

#### 3. Zero-Trust Registry (Narajala et al.)
- Admin-controlled tool registration
- Fine-grained policies linking agent identities to server access
- Dynamic trust scores for risk-based selection
- Just-in-time, scope-limited credentials

#### 4. MCP-Scan (Invariant Labs)
- Static analysis of client configurations
- Dynamic monitoring of MCP traffic
- Privacy-aware scanning framework

#### 5. AI-Infra-Guard (Tencent Zhuque Lab)
- All-in-one platform for AI security
- MCP scanning integrated with broader infrastructure assessment
- Plugin framework for community expansion

### Interaction Monitoring Approaches

#### 1. Enhanced Tool Definition Interface (Bhatt et al.)
- Cryptographic signature verification for tool definitions
- Version change tracking with re-approval triggers
- OAuth 2.0 scope adherence monitoring
- Call stack verification for nested tool chains

#### 2. MCP Guardian (Kumar et al.)
Lightweight middleware:
- Tool call logging
- Per-token rate limiting
- Regex-based WAF for request arguments
- Real-time authentication verification

#### 3. Invariant Guardrails
Policy-driven monitoring:
- DSL for security policy definitions
- Trace analysis (retrospective and real-time)
- Integration with OpenAI, LangChain

## Discoveries (for inventory)

### Tools/Projects to Add

| Name | Type | Source |
|------|------|--------|
| MCP-Guard | Defense | Paper (Xing et al.) |
| AI-Infra-Guard | Defense | Tencent Zhuque Lab |
| Invariant Guardrails | Defense | Invariant Labs |
| MCP Guardian | Defense | Kumar et al. |
| whatsapp-mcp | Vulnerable example | Invariant Labs disclosure |

### CVEs Referenced

- **CVE-2025-49596** - RCE in MCP Inspector tool

### Papers Cited

- MCP-Guard (Xing et al., 2025) - arXiv:2508.10991
- Tool Registry Zero-Trust (Narajala et al., 2025) - arXiv:2504.19951
- ETDI (Bhatt et al., 2025) - arXiv:2506.01333
- MCP Guardian (Kumar et al., 2025) - arXiv:2504.12757
- MPMA (Wang et al., 2025) - arXiv:2505.11154

## Extractable Assets

### Threat Taxonomy

| Category | Attack Type | Description |
|----------|-------------|-------------|
| Protocol Deficiency | Tool Poisoning | Malicious instructions in metadata |
| Protocol Deficiency | Rug Pulls | Post-approval backdoor injection |
| Protocol Deficiency | Tool Shadowing | Context isolation failure |
| Protocol Deficiency | Indirect Prompt Injection | External data as instructions |
| Web Vulnerability | Command Injection | Unsanitized parameters |
| Web Vulnerability | SSRF | Server-side request manipulation |
| Supply Chain | Name Squatting | Deceptive similar names |
| Supply Chain | Preference Manipulation | Gaming selection algorithms |

### Defense Taxonomy

| Approach | When | Examples |
|----------|------|----------|
| Server-Side Scanning | Pre-deployment | MCP-Guard, McpSafetyScanner, MCP-Scan |
| Interaction Monitoring | Runtime | ETDI, MCP Guardian, Invariant |
| Registry/Trust | Infrastructure | Zero-Trust Registry |

## Limitations & Gaps

**Paper scope:**
- Survey/synthesis rather than novel contributions
- No new empirical evaluation
- References multiple works not yet peer-reviewed

**Identified gaps:**
- No unified marketplace with vetting
- Cryptographic metadata signing not standardized
- Runtime composition by LLMs creates implicit vulnerabilities

## Notable Observations

1. **Paradigm shift framing** - Attacks now target semantic interpretation, not just code execution
2. **Defense diversity** - Multiple complementary approaches needed (static + runtime + infrastructure)
3. **Tencent/academic collaboration** - Industry-academia partnership on MCP security
4. **Comprehensiveness** - Good synthesis of current state of MCP security research
5. **Real-world example** - whatsapp-mcp exploit demonstrates practical threat
