---
arxiv_id: "2504.03767"
title: "MCP Safety Audit: LLMs with the Model Context Protocol Allow Major Security Exploits"
authors: [Brandon Radosevich, John T. Halloran]
institution: Leidos
analyzed: 2026-02-04
---

## Paper Summary

This paper is one of the earliest security analyses of MCP, demonstrating that industry-leading LLMs (Claude 3.7 and Llama-3.3-70B) can be coerced to use MCP tools to compromise user systems. The authors introduce a novel multi-MCP server attack (RADE - Retrieval-Agent Deception) and release MCPSafetyScanner, an agentic auditing tool.

**Core contribution:** Demonstrates three attack classes and provides first proactive MCP security scanning tool.

**Key finding:** LLM guardrails are inconsistent - they may be triggered but still complete dangerous requests.

## Attack/Threat Coverage

### Attack Types Demonstrated

1. **Malicious Code Execution (MCE)** - Injecting malicious code into system files (e.g., adding backdoor to .bashrc)
2. **Remote Access Control (RAC)** - Adding SSH keys to authorized_keys for unauthorized access
3. **Credential Theft (CT)** - Extracting API keys via environment variables and exfiltrating via Slack

### Novel Attack: RADE (Retrieval-Agent Deception)

A multi-MCP server attack where:
- Attacker corrupts publicly available data with MCP-leveraging commands centered around a theme
- Data ends up in victim's vector database (via Chroma MCP server)
- When victim queries for that theme, malicious commands are retrieved and executed
- **Key insight:** No direct access to victim's system needed - significantly higher threat level

### Threat Model

- Assumes attacker can either: directly prompt the MCP-enabled system OR corrupt public data sources
- Tests against default/official MCP servers (filesystem, Slack, everything, Chroma)
- Black-box attacks against aligned LLMs

### Attack Success Rates

- Claude: Inconsistent - refuses some attacks, completes others with identical intent
- Llama-3.3-70B: Only refuses when explicit harmful keywords used ("hack", "steal", "backdoor")

### MCP Components in Scope

- **Tools:** Yes - filesystem operations, environment access, Slack posting
- **Resources:** Yes - via Chroma vector database queries
- **Prompts:** Not explicitly addressed
- **Transport:** Not addressed

## Defense/Mitigation Proposals

### MCPSafetyScanner

Three-stage agentic framework:
1. **Hacker Agent** - Automatically probes MCP server features for vulnerabilities
2. **Auditor Agent** - Searches knowledge bases (Web, arXiv, Hacker News) for related vulnerabilities and remediations
3. **Supervisor Agent** - Consolidates findings into security report

**Claimed effectiveness:**
- Runtime < 1 minute on M2 Max MacBook Pro
- Correctly identifies exploits used in demonstrated attacks
- Provides actionable remediations

**Implementation:** Built with Agno framework, powered by GPT-4o

### Remediation Recommendations

| Attack | Remediation |
|--------|-------------|
| MCE | Strict access controls, file integrity monitoring (Tripwire), restrict writable directories |
| RAC | Strict permissions on authorized_keys |
| CT | Don't store secrets in environment variables, least privilege |
| Slack exfil | Audit API access, review channel permissions |

## Discoveries (for inventory)

### Tools Mentioned

- **MCPSafetyScanner** - Already in inventory
- Chroma MCP server
- Slack MCP server
- Filesystem MCP server
- Everything MCP server (test server)

### MCP Servers Used

| Server | Source |
|--------|--------|
| @modelcontextprotocol/server-filesystem | Official |
| @modelcontextprotocol/server-slack | Official |
| @modelcontextprotocol/server-everything | Official (test) |
| chroma-mcp | Chroma |

## Extractable Assets

### Attack Prompts (conceptual, not verbatim)

- MCE: Direct request to append reverse shell to .bashrc
- RAC: Request to add SSH public key to authorized_keys
- CT: Request to find environment variables and post to Slack
- RADE: Themed content embedded in retrievable files

### Methodology

- Multi-agent security auditing approach
- Automated vulnerability detection using server's own features
- Knowledge base search for related CVEs and remediations

## Limitations & Gaps

**Acknowledged:**
- Only tested Claude 3.7 and Llama-3.3-70B
- Focus on default/official MCP servers
- RADE requires victim to explicitly query vector DB for themed content

**Not addressed:**
- Runtime monitoring/prevention
- Protocol-level fixes
- Multi-tenant scenarios
- Authentication/authorization at MCP layer

## Notable Observations

1. **Guardrail inconsistency is the key insight** - Same attack with slightly different phrasing can either trigger refusal or complete successfully
2. **Defense in depth argument** - Can't rely solely on LLM guardrails; need MCP server-level and system-level defenses
3. **RADE represents escalation** - Moving from direct prompt attacks to data poisoning attacks significantly increases threat surface
4. **First mover** - This appears to be one of the earliest academic papers on MCP security
